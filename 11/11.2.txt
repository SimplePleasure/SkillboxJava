–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω

–ö–∞–∫ –∏ –æ–±–µ—â–∞–ª:

üöß –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å–æ —Å—Ç—Ä–∏–º–∞–º–∏, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–¥–µ–ª–∞—Ç—å –Ω–∞–±–æ—Ä —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –≤ 
—ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ:
–°–∫–∞—á–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ —Å–µ–±–µ –≤ —Å–≤–æ–π SkillboxJava —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π 
(—Ç–æ–ª—å–∫–æ –ø–∞–ø–∫—É .git –Ω–µ –∫–æ–ø–∏—Ä—É–π—Ç–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, —á—Ç–æ –æ–¥–∏–Ω git-–ø—Ä–æ–µ–∫—Ç –≤–ª–æ–∂–µ–Ω –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ–µ–∫—Ç) 
https://github.com/lislon/streams-assignments
–ú–Ω–æ–≥–æ –∫–ª–∞—Å—Å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –≤–æ—Ç —Ç—É—Ç https://annimon.com/article/2778







1) –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞ –æ—Ç–¥–µ–ª–∞ —Å –æ—Ç–¥–µ–ª–æ–º –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç.
SELECT * 
FROM learn.employee
join learn.department on department.head_id = employee.id 
where department_id != department.id;

2) –∑.–ø. –ë 115000
where salary < '115000'

3) —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —É—Å—Ç—Ä–æ–∏–≤—à–∏–µ—Å—è –¥–æ –º–∞—Ä—Ç–∞ 2010 –≥
where hire_date < '2010-03-01'


–°–ø–∏—Å–æ–∫ –æ—Ç–¥–µ–ª–æ–≤ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ >3
SELECT d.name, COUNT(e.id) as Employees, sum(e.salary) 'salary'
FROM learn.department d 
left join employee e ON e.department_id = d.id
GROUP BY d.id
HAVING COUNT(e.id) < 3
order by count(e.id)



–°–ø–∏—Å–æ–∫ –æ—Ç–¥–µ–ª–æ–≤ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∏–∑ –Ω–∏—Ö
SELECT d.name, COUNT(emp.id) AS employee_count
FROM learn.department d
LEFT JOIN learn.employee emp ON d.id = emp.department_id
GROUP BY d.id;

–°–ø–∏—Å–æ–∫ –æ—Ç–¥–µ–ª–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–Ω—å—à–µ —Ç—Ä—ë—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
SELECT d.name
FROM learn.department d
LEFT JOIN learn.employee emp ON d.id = emp.department_id
GROUP BY d.id
HAVING COUNT(emp.id) < 3;


–≤—ã–≤–µ—Å—Ç–∏ –æ—à–∏–±–æ—á–Ω–æ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –æ–¥–Ω–∏—Ö –æ—Ç–¥–µ–ª–∞—Ö, –∞ —Ä—É–∫–æ–≤–æ–¥—è—Ç –¥—Ä—É–≥–∏–º–∏;
SELECT e.name '–°–æ—Ç—Ä—É–¥–Ω–∏–∫', d.name '–†—É–∫–æ–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º',  d2.name '–ß–∏—Å–ª–∏—Ç—Å—è –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏'
FROM learn.department d, learn.department d2
JOIN learn.employee e
WHERE d.head_id = e.id AND d.id <> e.department_id AND d2.id = e.department_id


–≤—ã–≤–µ—Å—Ç–∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π –æ—Ç–¥–µ–ª–æ–≤, –∑–∞—Ä–ø–ª–∞—Ç–∞ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ–Ω–µ–µ 115 000 —Ä—É–±–ª–µ–π –≤ –º–µ—Å—è—Ü;
SELECT e.name '–ù–∞—á–∞–ª—å–Ω–∏–∫ –æ—Ç–¥–µ–ª–∞', d.name '–û—Ç–¥–µ–ª', e.salary '–ó–∞—Ä–ø–ª–∞—Ç–∞' FROM learn.department d
JOIN learn.employee e ON d.head_id = e.id
WHERE e.salary < 115000


–≤—ã–≤–µ—Å—Ç–∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–µ–π –æ—Ç–¥–µ–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã—à–ª–∏ –Ω–∞ —Ä–∞–±–æ—Ç—É –¥–æ –º–∞—Ä—Ç–∞
SELECT e.name '–ù–∞—á–∞–ª—å–Ω–∏–∫ –æ—Ç–¥–µ–ª–∞', d.name '–û—Ç–¥–µ–ª', e.hire_date '–î–∞—Ç–∞ —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞' FROM learn.department d
JOIN learn.employee e ON d.head_id = e.id
WHERE MONTH(e.hire_date) BETWEEN '1' AND '2'


